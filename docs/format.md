# format - prepare SAM files to dnmtools analysis

## Synopsis

```shell
$ dnmtools format [OPTIONS] -f <mapper>  <input.sam>
```

## Description

Not all bisulfite sequencing mappers use the same formats for their
output files. Before analyzing the output SAM generated by mappers,
some formatting is required. The first formatting step is to merge
paired-end mates into single-end entries. This is particularly
important to quantify methylation, as fragments that overlap must
count the overlapping bases only once and must be treated as
originating from the same allele. These can be ensured by merging them
into a single entry.  SAM/BAM files generated by abismal, Bismark and
BSMAP can be formatted using the `format` command. An example use of
this command to format a mapped reads file is:
```shell
$ dnmtools format -f abismal -o input-formatted.sam input.sam
```
Above, the file `input.sam` would have been generated by `abismal`.

## Options

```txt
-f, -format
```
This option indicates the format of the input SAM file, corresponding
to the mapper that generated it (options: abismal, bsmap, bismark).

```txt
-o, -output
```
The name of the output file. The output will be in SAM format. By
default this is standard output.

```txt
-s, -suffix
```
The length of the suffix for read names, which indicates whether the
read is from end 1 or end 2 (default: 1).

```txt
-L, -max-frag
```
The maximum allowed insert size in base-pairs (default:
10000). Normally this parameter is set at the mapping step, but
`format` can also reject reads that are in opposing strands in the
same chromosome but map more than "max-frag" bases apart.

```txt
-B, -buf-size
```
Maximum buffer size (default: 10000). This is the maximum
number of reads retained before mates are no longer seeked for
reads. If more than "buf-size" reads are not a proper mate of a given
read, the read is printed as-is and reported as single-end. This value
has no effect if the input is single-end.

```txt
-v, -verbose
```
Report more information while the program is running.
